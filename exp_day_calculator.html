<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>リネージュM Lvアップ到達日数計算機</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 20px; background-color: #f4f7f6; color: #333; }
        .container { max-width: 500px; margin: 0 auto; background-color: #fff; padding: 20px 30px; border-radius: 10px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1); }
        h1 { 
            color: #5a4b70; 
            text-align: center; 
            border-bottom: 2px solid #5a4b70; 
            padding-bottom: 10px; 
            margin-bottom: 20px; 
            font-size: 20px !important; /* Googleサイト埋め込み対応 */
        }
        .input-group { margin-bottom: 15px; }
        label { display: block; margin-top: 10px; font-weight: bold; color: #555; }
        input[type="number"] { width: 100%; padding: 10px; margin-top: 5px; border: 1px solid #ccc; border-radius: 5px; box-sizing: border-box; }
        button { background-color: #5a4b70; color: white; padding: 10px 15px; border: none; border-radius: 5px; cursor: pointer; margin-top: 20px; width: 100%; font-size: 16px; transition: background-color 0.3s; }
        button:hover { background-color: #7b6a9a; }
        .result-box { margin-top: 30px; padding: 15px; border: 2px solid #76c7c0; border-radius: 5px; background-color: #e6f7ff; text-align: center; }
        .result-title { font-size: 1.2em; font-weight: bold; color: #5a4b70; margin-bottom: 5px; }
        .result-value { font-size: 1.8em; font-weight: bold; color: #2ecc71; }
        .error { color: #e74c3c; font-weight: bold; margin-top: 15px; text-align: center; }
    </style>
</head>
<body>

<div class="container">
    <h1>Lvアップ到達日数計算機</h1>
    
    <div class="input-group">
        <label for="startLevel">現在のレベル (70〜91):</label>
        <input type="number" id="startLevel" value="70" min="70" max="91">
    </div>
    <div class="input-group">
        <label for="startExpPercent">現在の経験値 % (0.00〜99.99):</label>
        <input type="number" id="startExpPercent" value="0.00" min="0" max="99.99" step="0.01">
    </div>

    <div class="input-group">
        <label for="targetLevel">目標レベル (71〜92):</label>
        <input type="number" id="targetLevel" value="80" min="71" max="92">
    </div>
    
    <div class="input-group">
        <label for="dailyExpPercent">1日の目標獲得経験値 % (Lv内, 例: 0.15):</label>
        <input type="number" id="dailyExpPercent" value="0.15" min="0.01" step="0.01">
        <small style="display: block; color: #777; margin-top: 5px;">* 毎日Lvアップに必要な経験値の何%を稼ぐか</small>
    </div>

    <button onclick="calculateDays()">到達日数を計算</button>

    <div id="resultMessage" class="error" style="display:none;"></div>

    <div id="resultBox" class="result-box" style="display:none;">
        <div class="result-title">目標到達日</div>
        <div id="targetDate" class="result-value"></div>
        <div class="result-title" style="margin-top: 10px;">到達までの合計日数</div>
        <div id="totalDays" class="result-value"></div>
    </div>
</div>

<script>
    // --- 経験値テーブル (Lv -> Lv+1 に必要な経験値) ---
    const EXP_TABLE = {
        70: 3053845880,
        71: 4203633183,
        72: 5029842893,
        73: 5939314180,
        74: 6965402260,
        75: 8123518644,
        76: 9459816688,
        77: 10940822831,
        78: 12630907937,
        79: 15362882171,
        80: 17822734896,
        81: 20001626310,
        82: 22415537902,
        83: 25096518006,
        84: 28038365232,
        85: 31296843514,
        86: 34889606498,
        87: 116539565644,
        88: 466158342576,
        89: 1684633370304,
        90: 7458533481216,
        91: 36,362,347,267,020
        92: 218,174,083,602,140
    };

    /**
     * 計算を実行し、結果を表示する
     */
    function calculateDays() {
        const startLevel = parseInt(document.getElementById('startLevel').value);
        const startExpPercent = parseFloat(document.getElementById('startExpPercent').value);
        const targetLevel = parseInt(document.getElementById('targetLevel').value);
        const dailyExpPercent = parseFloat(document.getElementById('dailyExpPercent').value);
        
        const resultMessage = document.getElementById('resultMessage');
        const resultBox = document.getElementById('resultBox');
        
        // --- 初期化 ---
        resultMessage.style.display = 'none';
        resultBox.style.display = 'none';
        
        // --- 検証 ---
        if (startLevel < 70 || targetLevel > 92 || startLevel >= targetLevel || EXP_TABLE[startLevel] === undefined) {
            resultMessage.textContent = 'エラー: Lv設定を確認してください (開始Lv: 70-91, 目標Lv: 71-92, 開始Lv < 目標Lv)。';
            resultMessage.style.display = 'block';
            return;
        }
        if (startExpPercent < 0 || startExpPercent >= 100 || dailyExpPercent <= 0) {
            resultMessage.textContent = 'エラー: 経験値%は正しく入力してください (現在EXP: 0-99.99, 1日EXP: 0より大)。';
            resultMessage.style.display = 'block';
            return;
        }
        
        // --- 計算ロジック ---
        let totalRequiredExp = 0;
        
        // 1. 開始レベルの残り経験値を加算
        const startLevelTotalExp = EXP_TABLE[startLevel];
        const remainingExpInStartLevel = startLevelTotalExp * (1 - startExpPercent / 100.0);
        totalRequiredExp += remainingExpInStartLevel;

        // 2. 開始レベル+1から目標レベル-1までの経験値を加算
        for (let lv = startLevel + 1; lv < targetLevel; lv++) {
            if (EXP_TABLE[lv] !== undefined) {
                totalRequiredExp += EXP_TABLE[lv];
            }
        }
        
        // 3. 1日あたりの目標獲得経験値（実数値）を計算
        // ここが重要：日々の獲得EXPは「そのLvの獲得EXP」に対する割合として概算する。
        // 目標Lvに到達するまでのLvで最もコストの高いLvのコストを基準とします。
        
        let maxExpCost = 0;
        for (let lv = startLevel; lv < targetLevel; lv++) {
            if (EXP_TABLE[lv] > maxExpCost) {
                maxExpCost = EXP_TABLE[lv];
            }
        }
        
        // 1日あたりの獲得経験値（実数値） = 最大コスト * (1日の目標獲得経験値% / 100)
        // ※この概算方法が、ユーザー入力（Lv内の%）との整合性が最も高くなります。
        const dailyExpIncrease = maxExpCost * (dailyExpPercent / 100.0);
        
        if (dailyExpIncrease === 0) {
            resultMessage.textContent = 'エラー: 1日の獲得経験値が少なすぎます。';
            resultMessage.style.display = 'block';
            return;
        }
        
        // 4. 到達に必要な合計日数を計算
        const totalDaysFloat = totalRequiredExp / dailyExpIncrease;
        const totalDays = Math.ceil(totalDaysFloat); // 日数なので切り上げ
        
        // 5. 目標日を計算
        const today = new Date();
        const targetDate = new Date(today);
        targetDate.setDate(today.getDate() + totalDays);
        
        const targetDateStr = targetDate.toLocaleDateString('ja-JP', { year: 'numeric', month: 'long', day: 'numeric' });
        
        // --- 結果表示 ---
        document.getElementById('totalDays').textContent = `${totalDays.toLocaleString()} 日`;
        document.getElementById('targetDate').textContent = targetDateStr;
        resultBox.style.display = 'block';
    }

    // 初期値設定 (Googleサイト埋め込み時も動作するように)
    window.onload = function() {
        // 現在の日付に依存しないため、特に日付の初期設定は不要。
        // 入力値の範囲調整
        document.getElementById('startLevel').max = 91;
        document.getElementById('targetLevel').min = 71;
        document.getElementById('targetLevel').max = 92;
    };
</script>
</body>
</html>